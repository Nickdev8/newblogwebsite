name: blog.nickesselman.nl
services:
  web:
    build:
      context: .
      dockerfile: Dockerfile
    image: blog.nickesselman.nl:prod
    restart: unless-stopped
    env_file:
      - ./.env.prod
    environment:
      NODE_ENV: production
      PORT: "3000"
      HOST: "0.0.0.0"
      GITHUB_OWNER: "${GITHUB_OWNER}"
      GITHUB_TOKEN: "${GITHUB_TOKEN}"
      SMTP_HOST: "${SMTP_HOST}"
      SMTP_PORT: "${SMTP_PORT}"
      SMTP_SECURE: "${SMTP_SECURE}"
      SMTP_USER: "${SMTP_USER}"
      SMTP_PASSWORD: "${SMTP_PASSWORD}"
      EMAIL_FROM: "${EMAIL_FROM}"
      EMAIL_TO: "${EMAIL_TO}"
      FITBIT_TOKEN_DIR: "/app/data/fitbit"
    ports:
      - "127.0.0.1:3011:3000"
    working_dir: /app
    volumes:
      - ./app/src/posts:/app/src/posts
      - ./app/static/blogimages:/app/static/blogimages
      - ./app/data:/app/data
